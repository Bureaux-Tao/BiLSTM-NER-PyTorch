/Users/Bureaux/miniconda3/envs/Torch_ner/bin/python "/Users/Bureaux/Library/Application Support/JetBrains/Toolbox/apps/PyCharm-P/ch-0/213.5744.248/PyCharm.app/Contents/plugins/python/helpers/pydev/pydevconsole.py" --mode=client --port=63877
import sys; print('Python %s on %s' % (sys.version, sys.platform))
sys.path.extend(['/Volumes/Riesling/TRAIN/Torch-base/src/BiLSTM_CRF'])
Python 3.7.11 (default, Jul 27 2021, 07:03:16)
Type 'copyright', 'credits' or 'license' for more information
IPython 7.30.1 -- An enhanced Interactive Python. Type '?' for help.
PyDev console: using IPython 7.30.1
Python 3.7.11 (default, Jul 27 2021, 07:03:16)
[Clang 10.0.0 ] on darwin
In [2]: runfile('/Volumes/Riesling/TRAIN/Torch-base/src/BiLSTM_CRF/main.py', wdir='/Volumes/Riesling/TRAIN/Torch-base/src/BiLSTM_CRF')
-----------------------------------------------------------------------------------------------------------
               Layer (type)                                    Input Shape         Param #     Tr. Param #
===========================================================================================================
                Embedding-1                                      [100, 32]         180,300         180,300
                     LSTM-2     [100, 32, 300], [2, 32, 128], [2, 32, 128]         440,320         440,320
                  Dropout-3                                 [100, 32, 256]               0               0
                     LSTM-4       [100, 32, 256], [2, 32, 64], [2, 32, 64]         164,864         164,864
                  Dropout-5                                 [100, 32, 128]               0               0
                   Linear-6                                 [32, 100, 128]           3,741           3,741
                  Dropout-7                                  [32, 100, 29]               0               0
   ConditionalRandomField-8            [32, 100, 29], [32, 100], [32, 100]           1,860             899
===========================================================================================================
Total params: 791,085
Trainable params: 790,124
Non-trainable params: 961
-----------------------------------------------------------------------------------------------------------
training on  cpu
epoch [1]: 100%|██████████| 29/29 [00:11<00:00,  2.42it/s, loss=55.4]
2021-12-19 15:17:05,769 - epoch 1 - loss: 55.3747 acc: 0.0947 - test_acc: 0.0853
epoch [2]: 100%|██████████| 29/29 [00:12<00:00,  2.36it/s, loss=32.8]
2021-12-19 15:17:22,125 - epoch 2 - loss: 32.8019 acc: 0.5530 - test_acc: 0.4815
epoch [3]: 100%|██████████| 29/29 [00:12<00:00,  2.26it/s, loss=23.4]
2021-12-19 15:17:40,381 - epoch 3 - loss: 23.3587 acc: 0.7065 - test_acc: 0.6425
epoch [4]: 100%|██████████| 29/29 [00:13<00:00,  2.11it/s, loss=19.5]
2021-12-19 15:17:59,396 - epoch 4 - loss: 19.4523 acc: 0.7680 - test_acc: 0.6763
epoch [5]: 100%|██████████| 29/29 [00:18<00:00,  1.57it/s, loss=16.6]
2021-12-19 15:18:22,579 - epoch 5 - loss: 16.6216 acc: 0.8021 - test_acc: 0.7246
epoch [6]: 100%|██████████| 29/29 [00:13<00:00,  2.12it/s, loss=15]
2021-12-19 15:18:40,516 - epoch 6 - loss: 15.0233 acc: 0.8359 - test_acc: 0.7536
epoch [7]: 100%|██████████| 29/29 [00:12<00:00,  2.29it/s, loss=13.4]
2021-12-19 15:18:57,356 - epoch 7 - loss: 13.4273 acc: 0.8657 - test_acc: 0.7778
epoch [8]: 100%|██████████| 29/29 [00:12<00:00,  2.37it/s, loss=12.2]
2021-12-19 15:19:13,600 - epoch 8 - loss: 12.1736 acc: 0.8841 - test_acc: 0.7729
epoch [9]: 100%|██████████| 29/29 [00:12<00:00,  2.36it/s, loss=11.3]
2021-12-19 15:19:29,989 - epoch 9 - loss: 11.3147 acc: 0.8988 - test_acc: 0.7907
epoch [10]: 100%|██████████| 29/29 [00:12<00:00,  2.36it/s, loss=10.4]
2021-12-19 15:19:46,385 - epoch 10 - loss: 10.3500 acc: 0.9053 - test_acc: 0.7681
epoch [11]: 100%|██████████| 29/29 [00:12<00:00,  2.36it/s, loss=9.53]
2021-12-19 15:20:02,812 - epoch 11 - loss: 9.5281 acc: 0.9168 - test_acc: 0.7907
epoch [12]: 100%|██████████| 29/29 [00:12<00:00,  2.35it/s, loss=9.04]
2021-12-19 15:20:19,287 - epoch 12 - loss: 9.0429 acc: 0.9258 - test_acc: 0.7794
epoch [13]: 100%|██████████| 29/29 [00:13<00:00,  2.11it/s, loss=8.44]
2021-12-19 15:20:37,410 - epoch 13 - loss: 8.4381 acc: 0.9340 - test_acc: 0.7681
epoch [14]: 100%|██████████| 29/29 [00:13<00:00,  2.15it/s, loss=7.79]
2021-12-19 15:20:55,747 - epoch 14 - loss: 7.7892 acc: 0.9353 - test_acc: 0.7842
epoch [15]: 100%|██████████| 29/29 [00:13<00:00,  2.14it/s, loss=7.63]
2021-12-19 15:21:13,580 - epoch 15 - loss: 7.6291 acc: 0.9423 - test_acc: 0.7778
epoch [16]: 100%|██████████| 29/29 [00:13<00:00,  2.15it/s, loss=7.23]
2021-12-19 15:21:31,319 - epoch 16 - loss: 7.2328 acc: 0.9480 - test_acc: 0.7826
epoch [17]: 100%|██████████| 29/29 [00:12<00:00,  2.36it/s, loss=6.83]
2021-12-19 15:21:47,606 - epoch 17 - loss: 6.8298 acc: 0.9550 - test_acc: 0.7746
epoch [18]: 100%|██████████| 29/29 [00:12<00:00,  2.35it/s, loss=6.37]
2021-12-19 15:22:04,803 - epoch 18 - loss: 6.3710 acc: 0.9522 - test_acc: 0.7746
epoch [19]: 100%|██████████| 29/29 [00:12<00:00,  2.30it/s, loss=6.05]
2021-12-19 15:22:21,579 - epoch 19 - loss: 6.0456 acc: 0.9605 - test_acc: 0.7810
epoch [20]: 100%|██████████| 29/29 [00:12<00:00,  2.32it/s, loss=5.68]
2021-12-19 15:22:38,388 - epoch 20 - loss: 5.6803 acc: 0.9570 - test_acc: 0.7633
epoch [21]: 100%|██████████| 29/29 [00:13<00:00,  2.17it/s, loss=5.46]
2021-12-19 15:22:56,545 - epoch 21 - loss: 5.4569 acc: 0.9658 - test_acc: 0.7617
epoch [22]: 100%|██████████| 29/29 [00:16<00:00,  1.71it/s, loss=4.98]
2021-12-19 15:23:19,783 - epoch 22 - loss: 4.9781 acc: 0.9668 - test_acc: 0.7778
epoch [23]: 100%|██████████| 29/29 [00:17<00:00,  1.63it/s, loss=4.8]
2021-12-19 15:23:43,457 - epoch 23 - loss: 4.8041 acc: 0.9660 - test_acc: 0.7762
epoch [24]: 100%|██████████| 29/29 [00:16<00:00,  1.74it/s, loss=4.63]
2021-12-19 15:24:04,471 - epoch 24 - loss: 4.6330 acc: 0.9646 - test_acc: 0.7568
epoch [25]: 100%|██████████| 29/29 [00:13<00:00,  2.12it/s, loss=4.25]
2021-12-19 15:24:22,901 - epoch 25 - loss: 4.2473 acc: 0.9716 - test_acc: 0.7778
epoch [26]: 100%|██████████| 29/29 [00:12<00:00,  2.29it/s, loss=3.96]
2021-12-19 15:24:40,423 - epoch 26 - loss: 3.9598 acc: 0.9714 - test_acc: 0.7729
epoch [27]: 100%|██████████| 29/29 [00:14<00:00,  1.97it/s, loss=3.74]
2021-12-19 15:25:01,423 - epoch 27 - loss: 3.7388 acc: 0.9701 - test_acc: 0.7665
epoch [28]: 100%|██████████| 29/29 [00:14<00:00,  1.98it/s, loss=3.62]
2021-12-19 15:25:21,254 - epoch 28 - loss: 3.6245 acc: 0.9753 - test_acc: 0.7697
epoch [29]: 100%|██████████| 29/29 [00:13<00:00,  2.18it/s, loss=3.6]
2021-12-19 15:25:39,287 - epoch 29 - loss: 3.6048 acc: 0.9750 - test_acc: 0.7649
epoch [30]: 100%|██████████| 29/29 [00:15<00:00,  1.82it/s, loss=3.27]
2021-12-19 15:26:00,879 - epoch 30 - loss: 3.2667 acc: 0.9753 - test_acc: 0.7729
predicting training set: 100%|██████████| 29/29 [00:04<00:00,  6.91it/s]
predicting test set:   0%|          | 0/5 [00:00<?, ?it/s]
Train set
            ANATOMY     SIGN        QUANTITY    ORGAN       TEXTURE     DISEASE     DENSITY     BOUNDARY    MARGIN      DIAMETER    SHAPE       TREATMENT   LUNGFIELD   NATURE
precision   0.968       0.977       0.987       0.909       0.926       0.989       1.000       1.000       1.000       0.992       0.920       1.000       0.952       1.000
recall      0.974       0.976       0.974       0.851       1.000       0.986       1.000       1.000       1.000       0.992       0.958       1.000       1.000       1.000
f1          0.971       0.976       0.980       0.879       0.962       0.988       1.000       1.000       1.000       0.992       0.939       1.000       0.976       1.000
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
precision   0.973
recall      0.973
f1          0.973
predicting test set: 100%|██████████| 5/5 [00:00<00:00,  6.50it/s]
Test set
            ANATOMY     SIGN        QUANTITY    ORGAN       TEXTURE     DISEASE     DENSITY     BOUNDARY    MARGIN      DIAMETER    SHAPE       TREATMENT   LUNGFIELD   NATURE
precision   0.786       0.741       0.843       0.615       0.714       0.628       1.000       0.750       1.000       0.938       0.571       0.556       0.667       1.000
recall      0.794       0.697       0.814       0.667       1.000       0.600       1.000       1.000       0.857       0.938       1.000       0.417       1.000       1.000
f1          0.790       0.718       0.828       0.640       0.833       0.614       1.000       0.857       0.923       0.938       0.727       0.476       0.800       1.000
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
precision   0.768
recall      0.757
f1          0.763
