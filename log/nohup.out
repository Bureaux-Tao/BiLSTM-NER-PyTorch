--------------------------------------------------------------------------------------------------------------
               Layer (type)                                       Input Shape         Param #     Tr. Param #
==============================================================================================================
                Embedding-1                                        [256, 128]         536,400         536,400
                     LSTM-2     [256, 128, 300], [2, 128, 256], [2, 128, 256]       1,142,784       1,142,784
                  Dropout-3                                   [256, 128, 512]               0               0
                     LSTM-4     [256, 128, 512], [2, 128, 128], [2, 128, 128]         657,408         657,408
                  Dropout-5                                   [256, 128, 256]               0               0
          TimeDistributed-6                                   [128, 256, 256]           3,341           3,341
                  Dropout-7                                    [128, 256, 13]               0               0
   ConditionalRandomField-8            [128, 256, 13], [128, 256], [128, 256]             420             195
==============================================================================================================
Total params: 2,340,353
Trainable params: 2,340,128
Non-trainable params: 225
--------------------------------------------------------------------------------------------------------------
training on  cpu
epoch [1]: 100%|█████████████████████| 38/38 [02:16<00:00,  3.59s/it, loss=65.4]
2021-12-23 11:35:02,965 - epoch 1 - loss: 65.3639 acc: 0.2243 val_loss: 21.6087 val_acc: 0.1964
epoch [2]: 100%|█████████████████████| 38/38 [02:04<00:00,  3.29s/it, loss=29.7]
2021-12-23 11:38:10,371 - epoch 2 - loss: 29.7486 acc: 0.5719 val_loss: 12.0026 val_acc: 0.5058
epoch [3]: 100%|█████████████████████| 38/38 [02:06<00:00,  3.32s/it, loss=22.1]
2021-12-23 11:41:14,555 - epoch 3 - loss: 22.0580 acc: 0.7099 val_loss: 9.2177 val_acc: 0.6453
epoch [4]: 100%|█████████████████████| 38/38 [02:06<00:00,  3.33s/it, loss=18.2]
2021-12-23 11:44:18,399 - epoch 4 - loss: 18.1640 acc: 0.7833 val_loss: 8.2971 val_acc: 0.6895
epoch [5]: 100%|█████████████████████| 38/38 [02:02<00:00,  3.24s/it, loss=16.1]
2021-12-23 11:47:23,206 - epoch 5 - loss: 16.1152 acc: 0.8306 val_loss: 7.2306 val_acc: 0.7330
epoch [6]: 100%|█████████████████████| 38/38 [01:58<00:00,  3.11s/it, loss=14.1]
2021-12-23 11:50:24,777 - epoch 6 - loss: 14.0959 acc: 0.8500 val_loss: 7.1640 val_acc: 0.7419
epoch [7]: 100%|█████████████████████| 38/38 [02:05<00:00,  3.30s/it, loss=12.5]
2021-12-23 11:53:32,239 - epoch 7 - loss: 12.5184 acc: 0.8639 val_loss: 7.6330 val_acc: 0.7463
EarlyStopping counter: 1 out of 10
epoch [8]: 100%|█████████████████████| 38/38 [02:07<00:00,  3.34s/it, loss=11.1]
2021-12-23 11:56:41,437 - epoch 8 - loss: 11.0887 acc: 0.8795 val_loss: 7.3306 val_acc: 0.7479
EarlyStopping counter: 2 out of 10
epoch [9]: 100%|███████████████████████| 38/38 [02:01<00:00,  3.20s/it, loss=10]
2021-12-23 11:59:43,054 - epoch 9 - loss: 9.9951 acc: 0.8972 val_loss: 7.5721 val_acc: 0.7584
EarlyStopping counter: 3 out of 10
epoch [10]: 100%|████████████████████| 38/38 [02:01<00:00,  3.20s/it, loss=8.87]
2021-12-23 12:02:47,965 - epoch 10 - loss: 8.8729 acc: 0.9147 val_loss: 7.6724 val_acc: 0.7551
EarlyStopping counter: 4 out of 10
Epoch    10: reducing learning rate of group 0 to 5.0000e-04.
epoch [11]: 100%|█████████████████████| 38/38 [02:02<00:00,  3.23s/it, loss=7.8]
2021-12-23 12:05:51,141 - epoch 11 - loss: 7.8048 acc: 0.9317 val_loss: 8.5222 val_acc: 0.7474
EarlyStopping counter: 5 out of 10
epoch [12]: 100%|████████████████████| 38/38 [02:06<00:00,  3.32s/it, loss=7.14]
2021-12-23 12:08:59,069 - epoch 12 - loss: 7.1434 acc: 0.9410 val_loss: 9.1695 val_acc: 0.7546
EarlyStopping counter: 6 out of 10
epoch [13]: 100%|████████████████████| 38/38 [02:09<00:00,  3.40s/it, loss=6.76]
2021-12-23 12:12:10,392 - epoch 13 - loss: 6.7571 acc: 0.9526 val_loss: 9.0149 val_acc: 0.7623
EarlyStopping counter: 7 out of 10
epoch [14]: 100%|████████████████████| 38/38 [01:56<00:00,  3.06s/it, loss=6.23]
2021-12-23 12:15:09,792 - epoch 14 - loss: 6.2310 acc: 0.9552 val_loss: 9.7749 val_acc: 0.7468
EarlyStopping counter: 8 out of 10
Epoch    14: reducing learning rate of group 0 to 2.5000e-04.
epoch [15]: 100%|████████████████████| 38/38 [01:59<00:00,  3.14s/it, loss=5.84]
2021-12-23 12:18:09,680 - epoch 15 - loss: 5.8399 acc: 0.9615 val_loss: 10.0699 val_acc: 0.7496
EarlyStopping counter: 9 out of 10
epoch [16]: 100%|████████████████████| 38/38 [02:04<00:00,  3.28s/it, loss=5.59]
2021-12-23 12:21:18,497 - epoch 16 - loss: 5.5908 acc: 0.9668 val_loss: 10.4283 val_acc: 0.7590
EarlyStopping counter: 10 out of 10
Early stopping after epoch 16
predicting train set: 100%|█████████████████████| 38/38 [00:52<00:00,  1.39s/it]
Train set
            ANATOMY     TESTIMAGE   DISEASE     OPERATION   DRUG        TESTLAB
precision   0.959       0.979       0.978       0.954       0.984       0.948
recall      0.957       0.960       0.971       0.963       0.982       0.949
f1          0.958       0.969       0.975       0.959       0.983       0.949
------------------------------------------------------------------------------------
precision   0.966
recall      0.963
f1          0.965
predicting validate set: 100%|████████████████████| 6/6 [00:06<00:00,  1.10s/it]
Validate set
            ANATOMY     TESTIMAGE   DISEASE     OPERATION   DRUG        TESTLAB
precision   0.764       0.849       0.671       0.784       0.825       0.798
recall      0.742       0.730       0.671       0.770       0.932       0.766
f1          0.753       0.785       0.671       0.777       0.875       0.782
------------------------------------------------------------------------------------
precision   0.760
recall      0.751
f1          0.755